import{V as b,b as a,f as V,S as C,C as q,B as W,g as _,e as K,h as z,d as T,i as G,A as I,P as O,W as Z,j as Q,k as J}from"./three.module-920182d7.js";const x=new b,k=new V,g=new b;class N{constructor(H,X){this.object=H,this.domElement=X,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let l=0,f=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(e){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0;break}this.mouseDragOn=!0},this.onPointerUp=function(e){if(this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1;break}this.mouseDragOn=!1},this.onPointerMove=function(e){this.domElement===document?(this.pointerX=e.pageX-this.viewHalfX,this.pointerY=e.pageY-this.viewHalfY):(this.pointerX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=e.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(e){switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0;break}},this.onKeyUp=function(e){switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1;break}},this.lookAt=function(e,m,d){return e.isVector3?g.copy(e):g.set(e,m,d),this.object.lookAt(g),P(this),this},this.update=function(){const e=new b;return function(d){if(this.enabled===!1)return;if(this.heightSpeed){const B=a.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=d*(B*this.heightCoef)}else this.autoSpeedFactor=0;const n=d*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(n+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(n),this.moveLeft&&this.object.translateX(-n),this.moveRight&&this.object.translateX(n),this.moveUp&&this.object.translateY(n),this.moveDown&&this.object.translateY(-n);let v=d*this.lookSpeed;this.activeLook||(v=0);let D=1;this.constrainVertical&&(D=Math.PI/(this.verticalMax-this.verticalMin)),f-=this.pointerX*v,this.lookVertical&&(l-=this.pointerY*v*D),l=Math.max(-85,Math.min(85,l));let p=a.degToRad(90-l);const Y=a.degToRad(f);this.constrainVertical&&(p=a.mapLinear(p,0,Math.PI,this.verticalMin,this.verticalMax));const U=this.object.position;e.setFromSphericalCoords(1,p,Y).add(U),this.object.lookAt(e)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",R),this.domElement.removeEventListener("pointerdown",M),this.domElement.removeEventListener("pointermove",y),this.domElement.removeEventListener("pointerup",L),window.removeEventListener("keydown",F),window.removeEventListener("keyup",S)};const y=this.onPointerMove.bind(this),M=this.onPointerDown.bind(this),L=this.onPointerUp.bind(this),F=this.onKeyDown.bind(this),S=this.onKeyUp.bind(this);this.domElement.addEventListener("contextmenu",R),this.domElement.addEventListener("pointerdown",M),this.domElement.addEventListener("pointermove",y),this.domElement.addEventListener("pointerup",L),window.addEventListener("keydown",F),window.addEventListener("keyup",S);function P(e){const m=e.object.quaternion;x.set(0,0,-1).applyQuaternion(m),k.setFromVector3(x),l=90-a.radToDeg(k.phi),f=a.radToDeg(k.theta)}this.handleResize(),P(this)}}function R(c){c.preventDefault()}const r=document.querySelector("canvas.webgl-first-person-controls"),t={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",()=>{t.width=window.innerWidth,t.height=window.innerHeight,h.aspect=t.width/t.height,h.updateProjectionMatrix(),i.setSize(t.width,t.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2))});window.addEventListener("dblclick",()=>{document.fullscreenElement||document.webkitFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():r.requestFullscreen?r.requestFullscreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen()});const o=new C;o.background=new q("#222222");const $=new W(1,1,1),ee=new _({color:4500104}),u=new K($,ee);u.position.set(0,1,-5);u.receiveShadow=!0;u.castShadow=!0;o.add(u);const te=new z(10,10),ie=new T({color:"#707070",wireframe:!1}),w=new K(te,ie);w.rotation.x-=Math.PI/2;w.scale.x=3;w.scale.y=3;w.receiveShadow=!0;o.add(w);const E=new G("white",.8);E.position.set(0,3,0);E.castShadow=!0;o.add(E);let A=new I(4500104,.15);A.position.set(10,2,0);o.add(A);const h=new O(65,t.width/t.height,.1,1e3);h.position.set(0,.5,5);o.add(h);const i=new Z({canvas:r,antialias:!0});i.setPixelRatio(window.devicePixelRatio);i.setSize(t.width,t.height);i.shadowMap.enabled=!0;i.shadowMap.type=Q;const s=new N(h,r);s.lookSpeed=0;s.movementSpeed=2;s.noFly=!0;s.autoForward=!1;s.lookVertical=!0;s.dragToLook=!1;const oe=new J,j=()=>{const c=oe.getDelta();s.update(c),i.render(o,h),window.requestAnimationFrame(j)};j();
//# sourceMappingURL=first-person-controls-b08f7487.js.map
